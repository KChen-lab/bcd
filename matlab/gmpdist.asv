function [D] = gmpdist(X, S, th, r)
%GMPDIST Summary of this function goes here
%   Detailed explanation goes here
    if ~exist(r, 'var')
        r = size(X, 2);
    end
    if ~exist(th, 'var')
        th = 1e-6;
    end
    
    largest = eigs(S, 1);
    
    [v, s] = eigs(S, r);
    s = diag(s)
    mask = s / largest > th;
    s = s(mask)
    v = v(:, mask)
    
    D = 0
    
end

